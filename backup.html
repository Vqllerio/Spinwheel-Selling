<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ocean Spin Wheel - Symmetrical Colors</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <header>
        <h1><i class="fas fa-water"></i> Ocean Spin Wheel</h1>
        <p class="subtitle">Each spin removes the selected segment automatically</p>
    </header>

    <div class="container">
        <div class="wheel-section">
            <h2 class="section-title">Spin Wheel</h2>
            <div class="wheel-container">
                <div class="pointer-container">
                    <div class="pointer"></div>
                </div>
                <canvas id="wheelCanvas" width="400" height="400"></canvas>
            </div>
            <button id="spinButton" class="spin-btn">SPIN THE WHEEL!</button>

            <button id="soundToggle" class="sound-toggle active">
                <i class="fas fa-volume-up"></i> Sound On
            </button>
            <div class="sound-info">High-pitched segment sounds enabled</div>
        </div>

        <div class="info-section">
            <h2 class="section-title">Segment Info</h2>

            <div class="info-box">
                <div class="info-item">
                    <span class="info-label">Total Segments:</span>
                    <span class="info-value" id="segmentCount">26</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Last Removed:</span>
                    <span class="info-value" id="lastRemoved">None</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Status:</span>
                    <span class="info-value" id="status">Ready to spin</span>
                </div>
            </div>

            <div class="segment-list" id="segmentList">
                <!-- Segments will be listed here -->
            </div>
        </div>
    </div>

    <div id="resultModal">
        <div class="modal-content">
            <h2 class="modal-title">Spin Result!</h2>
            <div class="result-text" id="resultText"></div>
            <button class="modal-btn" id="closeModal">Continue</button>
        </div>
    </div>

    <footer>
        <p>Ocean Spin Wheel | Refresh page to reset</p>
    </footer>

    <script>
        // Define color palette
        const colors = ['#03297C', '#1F72CE', '#54CBEB', '#CB8F4F'];

        // Create symmetrical segments
        const initialSegments = [
            { label: '1', message: '!!COUPON!!' },
            { label: '2', message: 'Apa nama gunung tertinggi di dunia?' },
            { label: '3', message: 'Apa nama benua terbesar di dunia?' },
            { label: '4', message: 'Siapa penemu telepon?' },
            { label: '5', message: 'Siapa yang melukis “Starry Night”?' },
            { label: '6', message: 'Berasal dari Provinsi manakah Cerita Rakyat Malin Kundang?' },
            { label: '7', message: 'Dalam tradisi atau budaya masyarakat Indonesia, apa istilah yang menggambarkan konsep bekerja sama tanpa pamrih untuk menyelesaikan tugas atau kegiatan bersama?' },
            { label: '8', message: 'Di antara jenis buah tropis yang memiliki kulit berduri berdagang di pasar tradisional dan sangat populer. Buah tersebut juga memiliki aroma yang menyengat dan kadang beberapa orang tidak memakan buah tersebut. Buah apakah itu?' },
            { label: '9', message: 'Siapakah yang melukis lukisan “Mona Lisa”?' },
            { label: '10', message: 'Apa nama sungai terpanjang di dunia?' },
            { label: '11', message: 'Apa nama kota di Indonesia yang dikenal sebagai Kota Daeng?' },
            { label: '12', message: 'Apa nama Candi Buddha terbesar di Indonesia, terletak di Jawa Tengah?' },
            { label: '13', message: 'Apa julukan untuk Sulawesi Utara yang terkenal dengan keindahan bawah lautnya?' },
            { label: '14', message: 'Apa nama Gunung tertinggi yang ada di Sulawesi?' },
            { label: '15', message: 'Siapa nama Presiden Indonesia saat ini?' },
            { label: '16', message: 'Siapa presiden pertama Indonesia?' },
            { label: '17', message: 'Apa nama Negara yang dikenal dengan Menara Eiffel?' },
            { label: '18', message: 'Setiap tanggal berapakah Hari Kemerdekaan Indonesia diperingati?' },
            { label: '19', message: 'Siapa astronot pertama yang berjalan di bulan?' },
            { label: '20', message: 'Burung apakah yang tidak bisa terbang tetapi bisa berenang?' },
            { label: '21', message: 'Apa nama hewan tercepat di darat?' },
            { label: '22', message: 'Apa nama fenomena alam ketika Bulan menutupi Matahari?' },
            { label: '23', message: 'Apa istilah untuk hewan yang memakan tumbuhan?' },
            { label: '24', message: 'Apa nama bunga nasional Indonesia?' },
            { label: '25', message: 'Apa istilah untuk uang yang dipinjam dari bank?' },
            { label: '26', message: 'Apa nama bunga terbesar di dunia?' }
        ];

        // Assign colors symmetrically
        initialSegments.forEach((segment, index) => {
            segment.color = colors[index % colors.length];
        });

        let segments = [...initialSegments];
        let isSpinning = false;
        let currentRotation = 0;
        let animationId = null;
        let lastRemoved = null;
        let soundEnabled = true;
        let audioContext = null;
        let lastSegmentIndex = null;

        // DOM Elements
        const canvas = document.getElementById('wheelCanvas');
        const ctx = canvas.getContext('2d');
        const spinButton = document.getElementById('spinButton');
        const resultModal = document.getElementById('resultModal');
        const resultText = document.getElementById('resultText');
        const closeModal = document.getElementById('closeModal');
        const segmentCount = document.getElementById('segmentCount');
        const lastRemovedEl = document.getElementById('lastRemoved');
        const statusEl = document.getElementById('status');
        const segmentList = document.getElementById('segmentList');
        const soundToggle = document.getElementById('soundToggle');

        // Initialize the audio context on first user interaction
        function initAudioContext() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
            if (audioContext.state === 'suspended') {
                audioContext.resume();
            }
        }

        function playWinSound() {
            if (!soundEnabled || !audioContext) return;

            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();

            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(523.25, audioContext.currentTime);
            oscillator.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.1);
            oscillator.frequency.setValueAtTime(783.99, audioContext.currentTime + 0.2);

            gainNode.gain.setValueAtTime(0.5, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.8);

            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            oscillator.start();
            oscillator.stop(audioContext.currentTime + 0.8);
        }

        function playRemoveSound() {
            if (!soundEnabled || !audioContext) return;

            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();

            oscillator.type = 'square';
            oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(200, audioContext.currentTime + 0.2);

            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);

            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            oscillator.start();
            oscillator.stop(audioContext.currentTime + 0.2);
        }

        // Enhanced segment sound with higher pitch
        function playSegmentSound() {
            if (!soundEnabled || !audioContext) return;

            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();

            // Higher pitch configuration
            const baseFreq = 1000;
            const targetFreq = 700;

            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(baseFreq, audioContext.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(targetFreq, audioContext.currentTime + 0.05);

            gainNode.gain.setValueAtTime(0.25, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);

            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            oscillator.start();
            oscillator.stop(audioContext.currentTime + 0.1);

            // Visual feedback
            document.querySelector('.pointer').style.transform = 'scale(1.1)';
            setTimeout(() => {
                document.querySelector('.pointer').style.transform = '';
            }, 100);
        }

        // Initialize the wheel
        function initWheel() {
            drawWheel();
            updateSegmentList();
            segmentCount.textContent = segments.length;
            lastRemovedEl.textContent = lastRemoved || 'None';
            statusEl.textContent = 'Ready to spin';
        }

        // Draw the wheel with segments
        function drawWheel() {
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = Math.min(centerX, centerY) - 10;

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Draw background
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
            ctx.fillStyle = 'rgba(173, 216, 230, 0.3)';
            ctx.fill();
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.2)';
            ctx.lineWidth = 2;
            ctx.stroke();

            const anglePerSegment = (2 * Math.PI) / segments.length;

            segments.forEach((segment, i) => {
                // Draw segment
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius,
                    i * anglePerSegment,
                    (i + 1) * anglePerSegment);
                ctx.closePath();
                ctx.fillStyle = segment.color;
                ctx.fill();
                ctx.strokeStyle = '#1a3c5a';
                ctx.lineWidth = 1;
                ctx.stroke();

                // Draw label
                ctx.save();
                ctx.translate(centerX, centerY);
                ctx.rotate(i * anglePerSegment + anglePerSegment / 2);
                ctx.textAlign = 'right';
                ctx.fillStyle = '#fff';
                ctx.font = 'bold 16px Arial';
                ctx.fillText(segment.label, radius - 30, 5);
                ctx.restore();
            });

            // Draw center circle
            ctx.beginPath();
            ctx.arc(centerX, centerY, 20, 0, 2 * Math.PI);
            ctx.fillStyle = '#CB8F4F';
            ctx.fill();
            ctx.strokeStyle = '#a56d3c';
            ctx.lineWidth = 2;
            ctx.stroke();

            // Draw decorative rings
            ctx.beginPath();
            ctx.arc(centerX, centerY, 15, 0, 2 * Math.PI);
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.5)';
            ctx.lineWidth = 2;
            ctx.stroke();
        }

        // Update the segment list
        function updateSegmentList() {
            segmentList.innerHTML = '';

            segments.forEach(segment => {
                const item = document.createElement('div');
                item.className = 'segment-item';
                item.innerHTML = `
                    <div class="segment-color" style="background:${segment.color}"></div>
                    <div class="segment-label">${segment.label}</div>
                    <div class="segment-text">${segment.message}</div>
                `;
                segmentList.appendChild(item);
            });
        }

        // Animation function for smooth slowdown
        function animateSpin(startTime, targetRotation, winningSegment) {
            const now = Date.now();
            const elapsed = now - startTime;
            const spinDuration = 14000;

            // Calculate progress (0 to 1)
            let progress = Math.min(elapsed / spinDuration, 1);

            // Ease-out function for natural slowdown
            let easedProgress = 1 - Math.pow(1 - progress, 2.5);

            // Calculate current rotation
            let rotation = currentRotation + (targetRotation - currentRotation) * easedProgress;

            // Apply rotation
            canvas.style.transform = `rotate(${rotation}deg)`;

            // Check for segment transitions
            const currentSegment = calculateWinningSegment(rotation);
            if (lastSegmentIndex === null) {
                lastSegmentIndex = currentSegment;
            } else if (currentSegment !== lastSegmentIndex) {
                playSegmentSound();
                lastSegmentIndex = currentSegment;
            }

            // Continue animation until duration is complete
            if (progress < 1) {
                animationId = requestAnimationFrame(() => animateSpin(startTime, targetRotation, winningSegment));
            } else {
                // Animation complete
                isSpinning = false;
                spinButton.disabled = false;
                currentRotation = rotation % 360;
                lastSegmentIndex = null;
                showResult(winningSegment);
                animationId = null;
            }
        }

        // Calculate which segment is under the pointer
        function calculateWinningSegment(finalRotation) {
            // Normalize rotation to 0-360 degrees
            const normalizedRotation = (360 - (finalRotation % 360)) % 360;

            // Adjust for pointer position
            const adjustedRotation = (normalizedRotation + 360) % 360;

            // Calculate segment angle
            const segmentAngle = 360 / segments.length;

            // Calculate which segment is at the pointer
            const segmentIndex = Math.floor(adjustedRotation / segmentAngle);

            return segmentIndex % segments.length;
        }

        // Spin the wheel
        function spinWheel() {
            if (isSpinning || segments.length === 0) return;

            isSpinning = true;
            spinButton.disabled = true;
            statusEl.textContent = 'Spinning...';
            lastSegmentIndex = null;

            // Initialize audio context on first interaction
            if (!audioContext) {
                initAudioContext();
            }

            // Cancel any existing animation
            if (animationId) {
                cancelAnimationFrame(animationId);
            }

            // Random rotation (multiple full rotations)
            const spins = 10 + Math.floor(Math.random() * 5);
            const targetRotation = currentRotation + spins * 360 + Math.random() * 360;

            // Start animation
            const spinStartTime = Date.now();

            // Calculate winning segment
            const winningSegment = calculateWinningSegment(targetRotation);

            animateSpin(spinStartTime, targetRotation, winningSegment);
        }

        // Show result modal
        function showResult(segmentIndex) {
            const segment = segments[segmentIndex];
            resultText.innerHTML = `
                <div style="font-size: 2rem; margin-bottom: 20px; color: white">
                    Number ${segment.label}!
                </div>
                <div style="font-size: 1.4rem; padding: 0 20px;">${segment.message}</div>
            `;

            // Play win sound
            playWinSound();

            resultModal.classList.add('active');
        }

        // Close modal and remove the winning segment
        function closeResultModal() {
            if (segments.length > 0) {
                const winningSegmentIndex = calculateWinningSegment(currentRotation);
                const removedSegment = segments.splice(winningSegmentIndex, 1)[0];

                lastRemoved = `Segment ${removedSegment.label}`;
                lastRemovedEl.textContent = lastRemoved;

                // Play remove sound
                playRemoveSound();

                // Update the UI
                drawWheel();
                updateSegmentList();
                segmentCount.textContent = segments.length;

                if (segments.length === 0) {
                    statusEl.textContent = 'All segments removed!';
                    spinButton.disabled = true;
                } else {
                    statusEl.textContent = 'Ready to spin';
                }
            }

            resultModal.classList.remove('active');
        }

        // Toggle sound on/off
        function toggleSound() {
            soundEnabled = !soundEnabled;
            if (soundEnabled) {
                soundToggle.innerHTML = '<i class="fas fa-volume-up"></i> Sound On';
                soundToggle.classList.add('active');
            } else {
                soundToggle.innerHTML = '<i class="fas fa-volume-mute"></i> Sound Off';
                soundToggle.classList.remove('active');
            }
        }

        // Event Listeners
        spinButton.addEventListener('click', spinWheel);
        closeModal.addEventListener('click', closeResultModal);
        soundToggle.addEventListener('click', toggleSound);

        // Close modal when clicking outside
        resultModal.addEventListener('click', (e) => {
            if (e.target === resultModal) {
                closeResultModal();
            }
        });

        // Initialize the app
        initWheel();
    </script>
</body>

</html>